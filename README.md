# Using AI to diagnose patients with pneumonia
### Addressing the shortage of doctors in the US
The issue with the shortage of doctors predates COVID-19. This resulted in longer wait times, and poorer dynamics between patients and physicians. Additionally, when you factor in that doctors now deal with healthcare administration to give their patients proper care, it is no surprise that we are not getting the proper healthcare that we need. Northwell Health, one of the biggest healthcare providers in New York, needs proper patient care so that patients will not only just follow through with their treatment plans, but also may increase patient compliance. So what can we do to improve our healthcare while lessening the burnout that doctors are experiencing? By implementing AI in these hospitals, we can assuage some of the workload without diminishing patient care. Northwell can also use AI to train inexperienced nurses and doctors, [as multiple studies have found that AI is able to perform just as well as medical experts](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6716335/). This project will focus on developing an AI model that will be able to diagnose a pediatric patient with pneumonia by reading chest xrays. Hopefully the performance of the model will reassure that AI does have a place in the medical field.
### About the Data
The data consisted of chest x-rays of pediatric patients with or without pneumonia, provided by [Mendeley Data](https://data.mendeley.com/datasets/rscbjbr9sj/3). The data folder contains three folders: "chest_xray", "Augmented_Virus", and "Augmented". The "chest_xray" has two folders labeled "TRAIN" and "TEST", and each of these folders contain two more folders: "NORMAL" and "PNEUMONIA". However, the dataset in the "TRAIN" folder is unbalanced; the "NORMAL" data is a few thousand less than the "PNEUMONIA" data. In an attempt to balance these data, the augmented folders ("Augmented" and "Augmented_Virus") contain augmented images in order to increase the minority class. Since the "Data" folder is 1 GB, it will be stored in [Google Drive](https://drive.google.com/drive/folders/1LV79q3V7-VUANTYEe2hBgEfdSwolcagd?usp=drive_link).
### Creating the best neural network
To create the neural network that will return the best accuracy without overfitting, we start with a simple neural network, with only one hidden layer, and observe how the addition or replacement of layers improves the metrics of the model. We graph the metrics of each epoch to observe if there are any overfitting while simutaneously observing the changes in metrics like accuracy. The best model is saved in the file "normal_pneumonia_with_augmented_data.keras". The saved model can be found [here](https://drive.google.com/file/d/1B8m1rsUGkOWHf19led_infZOE2MBhe6x/view?usp=drive_link) as it is several hundred MB.
### Results
Running the test set through the model yielded these results:
<p align="center">
  <img src="https://github.com/Jko0425/Phase_4_project_image_recognition/blob/main/Images/Confusion%20Matrix.png" width="500" />
</p>
